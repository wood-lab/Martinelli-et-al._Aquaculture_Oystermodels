library(tidyverse)
library(tidyr)
library(plyr)
library(corrplot)
library(zoo)
library(lme4)
library(car)
library(lubridate)
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
head(prevalence)
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
#### CREATING SEASON
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
head(prevalence)
dmy(prevalence$Date1)
head(prevalence)
prevalence$Date1 <- dmy(prevalence$Date1)
prevalence$Date1
head(prevalence)
prevalence$Date <- dmy(prevalence$Date1)
head(prevalence)
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
str(prevalence$Date1)
head(prevalence)
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
prevalence.mat <- prevalence[, c(6,13:18)] # selecting the cols with
matrix <- cor(prevalence.mat, use="pairwise.complete.obs")
par(xpd = TRUE)
corrplot(matrix,method="number",type="lower",tl.col="black",tl.srt=45,mar=c(0,0,0,0))
#### CREATING SEASON
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- dmy(prevalence$Date1)
#### SCALING each column individually
###########################################################
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
head(prevalence)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Date1) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + Date1 + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
prevalence$Date1_sc <- scale(prevalence$Sate1, center = TRUE, scale = TRUE)
head(prevalence$Date1)
str(prevalence$Date1)
as.Date(prevalence$Sate1)
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
prevalence.mat <- prevalence[, c(6,13:18)] # selecting the cols with
matrix <- cor(prevalence.mat, use="pairwise.complete.obs")
par(xpd = TRUE)
corrplot(matrix,method="number",type="lower",tl.col="black",tl.srt=45,mar=c(0,0,0,0))
#### CREATING SEASON
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- dmy(prevalence$Date1)
#### SCALING each column individually
###########################################################
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
prevalence$Date1_sc <- scale(prevalence$Sate1, center = TRUE, scale = TRUE)
head(prevalence)
as.vector(prevalence$Sate1)
prevalence$Date1_sc <- scale(prevalence$Date1, center = TRUE, scale = TRUE)
head(prevalence)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Date1) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
anova(model1)
vif(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + Date1 + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Year) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
head(prevalence)
prevalence <- prevalence %>% separate(Date1, sep="/", into = c('Month', 'Day', 'Year'))
head(prevalence)
prevalence <- prevalence %>% separate(Date1, sep="-", into = c('Month', 'Day', 'Year'))
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
#### CREATING SEASON
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- dmy(prevalence$Date1)
prevalence <- prevalence %>% separate(Date1, sep="-", into = c('Month', 'Day', 'Year'))
head(prevalence)
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
########################
# CHECKING FOR CORRELATION IN oyster metrics
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
#### CREATING SEASON
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- dmy(prevalence$Date1)
prevalence <- prevalence %>% separate(Date1, sep="-", into = c('Year', 'Day', 'Month'))
#### SCALING each column individually
###########################################################
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
head(prevalence)
prevalence$Date <- dmy(prevalence$Date)
head(prevalence)
#### SCALING each column individually
###########################################################
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
prevalence$Date_sc <- scale(prevalence$Date, center = TRUE, scale = TRUE)
head(prevalence)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Date_sc) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Year) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season*Year + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
prevalence$Year_sc <- scale(prevalence$Year, center = TRUE, scale = TRUE)
prevalence$Year <- as.numeric(prevalence$Year)
prevalence$Year_sc <- scale(prevalence$Year, center = TRUE, scale = TRUE)
head(prevalence)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Year_sc) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + Year_sc + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + (1|Date) + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season*State + Thick_sc + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season*State  + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Season*State + State*Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + (1|Date) + Thick_sc + Season*State + State*Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
prevalence$Date
prevalence$Thick_sc
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Season*State + State*Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + Season*State + State*Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + Season + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + (1|Date) + Season + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
anova(model1)
getwd()
### WORKING DIRECTORY AND PACKAGES
###########################################################
library(tidyverse)
library(tidyr)
library(plyr)
library(corrplot)
library(zoo)
library(lme4)
library(car)
library(lubridate)
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
########################
# CHECKING FOR CORRELATION IN oyster metrics
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence.mat <- prevalence[, c(6,13:18)] # selecting the cols with
matrix <- cor(prevalence.mat, use="pairwise.complete.obs")
par(xpd = TRUE)
corrplot(matrix,method="number",type="lower",tl.col="black",tl.srt=45,mar=c(0,0,0,0))
#### CREATING SEASON
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- dmy(prevalence$Date1)
prevalence <- prevalence %>% separate(Date1, sep="-", into = c('Year', 'Day', 'Month'))
prevalence$Date <- dmy(prevalence$Date)
prevalence$Year <- as.numeric(prevalence$Year)
#### SCALING each column individually
###########################################################
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
prevalence$Date_sc <- scale(prevalence$Date, center = TRUE, scale = TRUE)
prevalence$Year_sc <- scale(prevalence$Year, center = TRUE, scale = TRUE)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + (1|Date) + Season + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + (1|Date) + Tissue_g_sc + Season + Culture + Ploidy + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + (1|Date) + Tissue_g_sc + Season + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + Culture + Ploidy + Tissue_g_sc + Season + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + Culture*State + Season*State + Ploidy + Tissue_g_sc + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + Culture + Season + Ploidy + Tissue_g_sc + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y_sc + Thick_sc + Culture + (1|Date) + Season + Ploidy + Tissue_g_sc + (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
########################
## WASHINGTON # glm as there's 9 single-farm bay, out of total 12 bays
wa <- subset(prevalence, prevalence$State =='WA')
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Culture + Season + Ploidy +  (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
anova(model1)
vif(model1)
########################
## WASHINGTON # glm as there's 9 single-farm bay, out of total 12 bays
wa <- subset(prevalence, prevalence$State =='WA')
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Date) + Culture + Season + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa)
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc +  Culture + Season + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + Ploidy +  (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa) # COVERGES WITHOUT DATE
###########################################################
## ADDING PREVALENCE DATASET
###########################################################
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- dmy(prevalence$Date1)
prevalence <- prevalence %>% separate(Date1, sep="-", into = c('Year', 'Day', 'Month'))
prevalence$Date <- dmy(prevalence$Date)
prevalence$Year <- as.numeric(prevalence$Year)
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
prevalence$Date_sc <- scale(prevalence$Date, center = TRUE, scale = TRUE)
prevalence$Year_sc <- scale(prevalence$Year, center = TRUE, scale = TRUE)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Culture + Season + Ploidy +  (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
######################## (1|Date) +
## WASHINGTON # glm as there's 9 single-farm bay, out of total 12 bays
wa <- subset(prevalence, prevalence$State =='WA')
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa) # COVERGES WITHOUT DATE
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Date) + Culture + Season + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa) # COVERGES WITHOUT DATE
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa) # COVERGES WITHOUT DATE
modelwa <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = wa)
summary(modelwa) # COVERGES WITHOUT DATE
## CALIFORNIA
ca <- subset(prevalence, prevalence$State =='CA')
modelca <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc +(1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = ca)
summary(modelca)
## CALIFORNIA
ca <- subset(prevalence, prevalence$State =='CA')
modelca <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc +(1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = ca)
modelca <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = ca)
summary(modelca)
modelor <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc+ (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = or)
## OREGON (no ploidy data for OR)
or <- subset(prevalence, prevalence$State =='OR')
modelor <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc+ (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = or)
summary(modelor)
or$Ploidy
modelor <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc+ (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = or)
or$Season
or$Culture
ca$Culture
wa$Culture
modelor <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc+ (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = or)
summary(modelor)
modelor <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = or)
## ALASKA
# glm as there's 4 single-farm bay, out of total 5 bays
ak <- subset(prevalence, prevalence$State =='AK') # only dips in AK
modelak <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + Ploidy + (1|Farm), family="binomial", data = ak)
ak$Ploidy
modelak <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + (1|Farm), family="binomial", data = ak)
modelak <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + (1|Year) + Culture + Season + (1|Farm), family="binomial", data = ak)
summary(modelak)
modelak <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Culture + Season + (1|Farm), family="binomial", data = ak)
summary(modelak)
modelor <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Culture + Season + Ploidy + (1|Bay/Farm), family="binomial", data = or)
summary(modelor)
## ALASKA
# glm as there's 4 single-farm bay, out of total 5 bays (1|Year)
ak <- subset(prevalence, prevalence$State =='AK') # only dips in AK
modelak <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Culture + Season + (1|Farm), family="binomial", data = ak)
summary(modelak)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ Tissue_g_sc + y_sc + Thick_sc + Culture + Season + Ploidy +  (1|State/Bay/Farm), family="binomial", data = prevalence)
summary(model1)
## trying out a plot
allstates <-ggpredict(model1,c("Summer"))
tidyverse_update()
