scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
mod2_dd
attempt <- ggplot(mod2_dd, aes(x= culture(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
#geom_abline(slope = 0, intercept = mean(DF), na.rm=T, lwd=0.5, col='black', lty=2) +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
level_order <- c('CA_on','CA_off','OR_on','OR_off','WA_on','WA_off','AK_on','AK_off')
attempt <- ggplot(mod2_dd, aes(x= culture(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
#geom_abline(slope = 0, intercept = mean(DF), na.rm=T, lwd=0.5, col='black', lty=2) +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
#geom_abline(slope = 0, intercept = mean(DF), na.rm=T, lwd=0.5, col='black', lty=2) +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
#geom_abline(slope = 0, intercept = mean(DF), na.rm=T, lwd=0.5, col='black', lty=2) +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,0.75) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
#geom_abline(slope = 0, intercept = mean(DF), na.rm=T, lwd=0.5, col='black', lty=2) +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,0.65) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
#stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
#geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,0.65) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,0.65) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,0.65) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,0.65) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 4)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03, color=factor(x)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03, color=factor(culture)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
mod2_dd
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03, color=factor(x)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03, color=factor(mod2_dd$x)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03, color=factor(mod2_dd$x)) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
mod2_dd$culture <- paste(mod2_dd$x, mod2_dd$group, sep=" ")
level_order <- c('CA on','CA off','OR on','OR off','WA on','WA off','AK on','AK off')
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75) ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75), color='grey70' ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75), color='grey50' ) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03,color='grey50') +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03,color='grey70') +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
attempt <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
attempt + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
allstates3 <- ggpredict(model2,c("State","Season"))
Fig5B <- ggplot(mod2_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
Fig5B + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
allstates3 <- ggpredict(model2,c("State","Season"))
allstates3_dd <- as.data.frame(allstates3)
allstates3_dd
allstates3_dd$culture <- paste(mod2_dd$x, mod2_dd$group, sep=" ")
level_order <- c('CA S','CA W','OR S','OR W','WA S','WA W','AK S','AK W')
allstates3_dd
allstates3_dd$culture <- paste(allstates3_dd$x, allstates3_dd$group, sep=" ")
level_order <- c('CA S','CA W','OR S','OR W','WA S','WA W','AK S','AK W')
allstates3
allstates3 <- ggpredict(model2,c("State","Season"))
allstates3_dd <- as.data.frame(allstates3)
allstates3_dd$culture <- paste(allstates3_dd$x, allstates3_dd$group, sep=" ")
level_order <- c('CA S','CA W','OR S','OR W','WA S','WA W','AK S','AK W')
allstates3_dd
Fig5A <- ggplot(allstates3_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=mod2_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
Fig5A + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
Fig5A <- ggplot(allstates3_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=allstates3_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
Fig5A + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
level_order <- c('CA S','CA W','OR S','OR W','WA S','WA W','AK S','AK W')
Fig5A <- ggplot(allstates3_dd, aes(x= factor(culture, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=allstates3_dd, mapping=aes(x=culture, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
Fig5A + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
level_order <- c('CA S','CA W','OR S','OR W','WA S','WA W','AK S','AK W')
allstates3_dd
level_order <- c('CA Summer','CA Winter','OR Summer','OR Winter','WA Summer','WA Winter','AK Summer','AK Winter')
allstates2
allstates3 <- ggpredict(model2,c("State","Season"))
allstates3
allstates3_dd <- as.data.frame(allstates3)
allstates3_dd
allstates3_dd$culture <- paste(allstates3_dd$x, allstates3_dd$group, sep=" ")
allstates3_dd
level_order <- c('CA Summer','CA Winter','OR Summer','OR Winter','WA Summer','WA Winter','AK Summer','AK Winter')
allstates3_dd$season <- paste(allstates3_dd$x, allstates3_dd$group, sep=" ")
level_order <- c('CA Summer','CA Winter','OR Summer','OR Winter','WA Summer','WA Winter','AK Summer','AK Winter')
allstates3_dd
Fig5A <- ggplot(allstates3_dd, aes(x= factor(season, level= level_order), y= predicted, fill= x, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar', width = 0.3, position = position_dodge(width = 0.75)) +
geom_errorbar(data=allstates3_dd, mapping=aes(x=season, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Predicted Infestation', size=16)
Fig5A + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
library(tidyverse)
library(tidyr)
library(plyr)
library(dplyr)
library(RColorBrewer) #display.brewer.all()
library(zoo)
library(corrplot)
library(lme4)
library(lubridate)
library(car)
library(wesanderson)
library(viridis)
library(ggeffects)
###########################################################
### BELLINGHAM
###########################################################
data <- read.table("Bellingham buoy/CSVs/Bellingham_buoy.csv", header=T,sep=",")
colnames(data) <- c('Date','DOsat', 'SST','Salinity','DOconc', 'Turbidity','Chlorophyll')
data <- mutate(data, Buoy = "Bellingham") # adding col for buoy
data$Date <- as.Date(data$Date)
# splitting into seasons and year
data <- as.data.frame(data)
yq <- as.yearqtr(as.yearmon(data$Date, "%m/%d/%Y") + 1/12)
data$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Spring", "Summer", "Fall"))
todrop <- which(data$Salinity > 50)
getwd()
library(plyr)
library(tidyverse)
library(corrplot)
library(zoo)
library(lme4)
library(car)
library(lubridate)
library(devtools)
library(ggeffects)
library(statmod)
library(wesanderson)
###########################################################
## ADDING DATASETS
###########################################################
summary_all <- read.table("sampling summary.csv", header=T,sep=",")
prevalence <- read.table("master_spreadsheet_all.csv", header=T,sep=",")
prevalence <- subset(prevalence, prevalence$Valve =='R') # only keep R valves
level_order <- c('CA', 'OR', 'WA', 'AK')
prev_state <- ggplot(summary_all, aes(x= factor(State, level= level_order), y= Prevalence, fill= State, show.legend = FALSE))  +
stat_boxplot(geom= 'errorbar' , width = 0.3, position = position_dodge(width = 0.75) ) +
geom_boxplot(alpha=0.7, lwd=1, outlier.shape = NA, show.legend = FALSE) +
geom_point(stat = "identity", size= 4, shape = 21, lwd=2, show.legend = FALSE) +
ylim(0,1) +
scale_fill_manual(values=wes_palette("GrandBudapest1", n = 4)) +
labs(x = 'State', y = 'Prevalence', size=16)
prev_state + theme_classic(base_size = 18) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
data_mean <- summary_all %>%
group_by(State) %>% #
summarize_at(vars(Prevalence), list(mean = mean), na.rm=TRUE)
data_median <- summary_all %>%
group_by(State) %>% #
summarize_at(vars(Prevalence), list(median = median), na.rm=TRUE)
data_state <- summary_all %>%
group_by(State) %>% #
summarize_at(vars(Total.oysters), list(sum = sum), na.rm=TRUE)
prevalence$Shell_g <- as.numeric(prevalence$Shell_g)
prevalence$Tissue_g <- as.numeric(prevalence$Tissue_g)
prevalence$Thick <- as.numeric(prevalence$Thick)
prevalence$x <- as.numeric(prevalence$x)
prevalence$y <- as.numeric(prevalence$y)
prevalence$z <- as.numeric(prevalence$z)
prevalence.mat <- prevalence[, c(6,13:18)] # selecting the cols with
matrix <- cor(prevalence.mat, use="pairwise.complete.obs")
par(xpd = TRUE)
corrplot(matrix,method="number",type="lower",tl.col="black",tl.srt=45,mar=c(0,0,0,0))
yq <- as.yearqtr(as.yearmon(prevalence$Date, "%m/%d/%Y") + 1/12)
prevalence$Season <- factor(format(yq, "%q"), levels = 1:4,
labels = c("Winter", "Winter", "Summer", "Summer"))
prevalence <- prevalence %>% mutate(Date1 = Date)
prevalence$Date1 <- mdy(prevalence$Date1)
prevalence <- prevalence %>% separate(Date1, sep="-", into = c('Year','Month', 'Day'))
prevalence$Date <- mdy(prevalence$Date)
prevalence$Year <- as.numeric(prevalence$Year)
prevalence$Lat_sc <- scale(prevalence$Lat, center = TRUE, scale = TRUE)
prevalence$Lng_sc <- scale(prevalence$Lng, center = TRUE, scale = TRUE)
prevalence$Shell_g_sc <- scale(prevalence$Shell_g, center = TRUE, scale = TRUE)
prevalence$Tissue_g_sc <- scale(prevalence$Tissue_g, center = TRUE, scale = TRUE)
prevalence$x_sc <- scale(prevalence$x, center = TRUE, scale = TRUE)
prevalence$y_sc <- scale(prevalence$y, center = TRUE, scale = TRUE)
prevalence$z_sc <- scale(prevalence$z, center = TRUE, scale = TRUE)
prevalence$Thick_sc <- scale(prevalence$Thick, center = TRUE, scale = TRUE)
prevalence$Date_sc <- scale(prevalence$Date, center = TRUE, scale = TRUE)
prevalence$Year_sc <- scale(prevalence$Year, center = TRUE, scale = TRUE)
## MODEL TESTING FOR PREVALENCE - ALL STATES
########################
model1 <- glmer(Infested ~ y + Culture + Ploidy + Season + Thick_sc + (1|Year_sc) + (1|State/Farm), family="binomial", data = prevalence)
summary(model1)
anova(model1)
vif(model1)
car::Anova(model1, type=3) # getting p-values
model2 <- glmer(Infested ~ y_sc + Season*State + Culture*State + (1|Year_sc) + (1|Farm), family="binomial", data = prevalence)
summary(model2)
anova(model2)
vif(model2)
car::Anova(model2, type=3) # getting p-values
## PLOTTING MODEL 1
########################
allstates <- ggpredict(model1,c("y","Season"))
allstates_plot<-ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=0.03) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
allstates_plot<-ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=0.03, position = position_dodge(width = 0.75)) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
allstates_plot<-ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=0.1, position = position_dodge(width = 0.5)) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
allstates_plot <- ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=0.5, position = position_dodge(width = 0.5)) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
allstates_plot <- ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=0.8, position = position_dodge(width = 0.5)) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
allstates_plot <- ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=1, position = position_dodge(width = 0.25)) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
allstates_plot <- ggplot(allstates,aes(x,predicted,color=group), color=group) +
scale_color_manual(values=wes_palette("GrandBudapest1", n = 2)) +
geom_point(size=4) +
geom_errorbar(data=allstates, mapping=aes(x=x, ymin=conf.low, ymax=conf.high), width=1, position = position_dodge(width = 0.5)) +
geom_line(aes(group=group)) +
xlab("Shell height (cm)") +
ylab(expression(paste("Predicted infestation"))) +
theme_classic() +
guides(color=guide_legend("Season")) +
theme(plot.title=element_text(size=14,hjust=0.5,face="plain"), axis.text.y=element_text(size=14),
axis.title.y=element_text(size=14), axis.text.x=element_text(size=14), axis.title.x=element_text(size=14),
panel.grid.minor=element_line(color=NA))
allstates_plot
